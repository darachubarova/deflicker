# ะะตัะพะดะธัะบะฐ: ะกะธััะตะผะฐ ััะฐะฑะธะปะธะทะฐัะธะธ ะผะฐัะพะบ ะฒะธะดะตะพัะตะณะผะตะฝัะฐัะธะธ

## ๐ ะะณะปะฐะฒะปะตะฝะธะต

1. [ะะฑะทะพั ัะธััะตะผั](#ะพะฑะทะพั-ัะธััะตะผั)
2. [ะััะธัะตะบัััะฐ](#ะฐััะธัะตะบัััะฐ)
3. [ะะพะผะฟะพะฝะตะฝัั ัะธััะตะผั](#ะบะพะผะฟะพะฝะตะฝัั-ัะธััะตะผั)
4. [ะกะตัะตะฒะฐั ะธะฝััะฐััััะบัััะฐ](#ัะตัะตะฒะฐั-ะธะฝััะฐััััะบัััะฐ)
5. [ะฃััะฐะฝะพะฒะบะฐ ะธ ะฝะฐัััะพะนะบะฐ](#ัััะฐะฝะพะฒะบะฐ-ะธ-ะฝะฐัััะพะนะบะฐ)
6. [ะะฐะฟััะบ ัะธััะตะผั](#ะทะฐะฟััะบ-ัะธััะตะผั)
7. [ะัะฟะพะปัะทะพะฒะฐะฝะธะต](#ะธัะฟะพะปัะทะพะฒะฐะฝะธะต)
8. [ะฃัััะฐะฝะตะฝะธะต ะฝะตะฟะพะปะฐะดะพะบ](#ััััะฐะฝะตะฝะธะต-ะฝะตะฟะพะปะฐะดะพะบ)
9. [ะะฟัะธะผะธะทะฐัะธั](#ะพะฟัะธะผะธะทะฐัะธั)

---

## ะะฑะทะพั ัะธััะตะผั

### ะงัะพ ะดะตะปะฐะตั ัะธััะตะผะฐ?

ะกะธััะตะผะฐ **Mask Stabilization** ัะตัะฐะตั ะฟัะพะฑะปะตะผั "ะผะตััะฐะฝะธั" (flickering) ะฟัะธ ะฟะพะบะฐะดัะพะฒะพะน ัะตะณะผะตะฝัะฐัะธะธ ะฒะธะดะตะพ. ะะพะณะดะฐ ะฝะตะนัะพัะตัั ะพะฑัะฐะฑะฐััะฒะฐะตั ะบะฐะถะดัะน ะบะฐะดั ะฝะตะทะฐะฒะธัะธะผะพ, ะผะฐัะบะธ ะพะฑัะตะบัะพะฒ ะผะพะณัั ะฝะตะผะฝะพะณะพ ะพัะปะธัะฐัััั ะผะตะถะดั ัะพัะตะดะฝะธะผะธ ะบะฐะดัะฐะผะธ, ัะพะทะดะฐะฒะฐั ัััะตะบั ะผะตััะฐะฝะธั.

### ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั?

1. **ะะฐะณััะทะบะฐ ะฒะธะดะตะพ** โ ะะธะดะตะพ ัะฐะทะฑะธะฒะฐะตััั ะฝะฐ ะพัะดะตะปัะฝัะต ะบะฐะดัั
2. **ะกะตะณะผะตะฝัะฐัะธั** โ ะะตะนัะพัะตัั DeepLabv3 ะฝะฐัะพะดะธั ะพะฑัะตะบัั ะฝะฐ ะบะฐะถะดะพะผ ะบะฐะดัะต
3. **ะกัะฐะฑะธะปะธะทะฐัะธั** โ ะัะตะผะตะฝะฝะพะต ัะณะปะฐะถะธะฒะฐะฝะธะต ัะฑะธัะฐะตั ะผะตััะฐะฝะธะต ะผะตะถะดั ะบะฐะดัะฐะผะธ
4. **ะะตััะธะบะธ** โ ะกะธััะตะผะฐ ะธะทะผะตััะตั ัะปัััะตะฝะธะต ััะฐะฑะธะปัะฝะพััะธ (IoU)

### ะะปััะตะฒัะต ะผะตััะธะบะธ

- **IoU (Intersection over Union)** โ ะผะตัะฐ ะฟะตัะตะบัััะธั ะผะฐัะพะบ ะผะตะถะดั ัะพัะตะดะฝะธะผะธ ะบะฐะดัะฐะผะธ
- **Instability Score** โ 1 - IoU (ัะตะผ ะฒััะต, ัะตะผ ะฑะพะปััะต ะผะตััะฐะฝะธะต)
- **Improvement** โ ะฟัะพัะตะฝั ัะปัััะตะฝะธั ะฟะพัะปะต ััะฐะฑะธะปะธะทะฐัะธะธ

---

## ะััะธัะตะบัััะฐ

### ะะฑัะฐั ััะตะผะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                        ะะะขะะะะะข                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                              โ
                              โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              ะะะจ WINDOWS-ะกะะะะะ (23.189.104.205)                โ
โ  โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ                     โ
โ  โ   ะะพัั 8080     โ    โ   ะะพัั 8000     โ                     โ
โ  โ   (Frontend)    โ    โ   (Backend)     โ                     โ
โ  โโโโโโโโโโฌโโโโโโโโโ    โโโโโโโโโโฌโโโโโโโโโ                     โ
โ           โ     SSH Reverse Tunnelโ                             โ
โโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
            โ                      โ
            โผ                      โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ           ะกะะะะะ ะฃะงะะะะะะ ะะะะะะะะะฏ (176.109.92.50)             โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ                   DOCKER-ะะะะขะะะะะ                        โ   โ
โ  โ  โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ              โ   โ
โ  โ  โ Python HTTP     โ    โ   FastAPI       โ              โ   โ
โ  โ  โ Server :8080    โ    โ   Uvicorn :8000 โ              โ   โ
โ  โ  โ (Frontend)      โ    โ   (Backend)     โ              โ   โ
โ  โ  โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ              โ   โ
โ  โ                              โ                            โ   โ
โ  โ                              โผ                            โ   โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ   โ
โ  โ  โ              ะะะะะะะขะะ ะะะะะ                      โ    โ   โ
โ  โ  โ  โข DeepLabv3 (ัะตะณะผะตะฝัะฐัะธั)                       โ    โ   โ
โ  โ  โ  โข MaskStabilizer (ััะฐะฑะธะปะธะทะฐัะธั)                 โ    โ   โ
โ  โ  โ  โข Metrics (ัะฐัััั IoU)                          โ    โ   โ
โ  โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ    โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ะะพัะตะผั ัะฐะบะฐั ััะตะผะฐ?

**ะัะพะฑะปะตะผะฐ:** Docker-ะบะพะฝัะตะนะฝะตั ะฝะฐ ัะตัะฒะตัะต ััะตะฑะฝะพะณะพ ะทะฐะฒะตะดะตะฝะธั ะฝะต ะธะผะตะตั ะฟััะผะพะณะพ ะดะพัััะฟะฐ ะบ ะพัะบัััะธั ะฟะพััะพะฒ (ัะฐะนัะฒะพะป ัะฟัะฐะฒะปัะตััั ัะฝะฐััะถะธ ะบะพะฝัะตะนะฝะตัะฐ).

**ะะตัะตะฝะธะต:** ะะฑัะฐัะฝัะน SSH-ััะฝะฝะตะปั ัะตัะตะท ะฒะฐั Windows-ัะตัะฒะตั, ั ะบะพัะพัะพะณะพ ะตััั ะฟัะฑะปะธัะฝัะน IP ะธ ะพัะบััััะต ะฟะพััั.

---

## ะะพะผะฟะพะฝะตะฝัั ัะธััะตะผั

### Backend (FastAPI + Uvicorn)

**ะะฐัะฟะพะปะพะถะตะฝะธะต:** `/tf/darachubarova/defliker/src/main.py`

**ะญะฝะดะฟะพะธะฝัั API:**

| ะะตัะพะด | ะััั | ะะฟะธัะฐะฝะธะต |
|-------|------|----------|
| GET | `/` | ะะฝัะพัะผะฐัะธั ะพะฑ API |
| POST | `/api/upload` | ะะฐะณััะทะบะฐ ะฒะธะดะตะพ |
| POST | `/api/segment` | ะะฐะฟััะบ ัะตะณะผะตะฝัะฐัะธะธ |
| POST | `/api/stabilize` | ะะฐะฟััะบ ััะฐะฑะธะปะธะทะฐัะธะธ |
| GET | `/api/status/{job_id}` | ะกัะฐััั ะทะฐะดะฐะฝะธั |
| GET | `/api/results/{job_id}` | ะะตะทัะปััะฐัั |
| GET | `/api/metrics/{job_id}` | ะะตััะธะบะธ |
| GET | `/api/frames/{job_id}/{type}/{num}` | ะะพะปััะธัั ะบะฐะดั |
| GET | `/api/classes` | ะะพัััะฟะฝัะต ะบะปะฐััั |
| DELETE | `/api/job/{job_id}` | ะฃะดะฐะปะธัั ะทะฐะดะฐะฝะธะต |

### Frontend (HTML + JavaScript)

**ะะฐัะฟะพะปะพะถะตะฝะธะต:** `/tf/darachubarova/defliker/frontend/index.html`

**ะคัะฝะบัะธะธ:**
- Drag & Drop ะทะฐะณััะทะบะฐ ะฒะธะดะตะพ
- ะัะฑะพั ะบะปะฐััะฐ ะพะฑัะตะบัะฐ (Person, Car, ะธ ั.ะด.)
- ะัะฑะพั ะผะตัะพะดะฐ ััะฐะฑะธะปะธะทะฐัะธะธ
- ะัะพะฑัะฐะถะตะฝะธะต ะฟัะพะณัะตััะฐ
- ะัะพัะผะพัั ัะตะทัะปััะฐัะพะฒ ะฟะพะบะฐะดัะพะฒะพ
- ะัะพะฑัะฐะถะตะฝะธะต ะผะตััะธะบ

### ะะพะดัะปะธ ะพะฑัะฐะฑะพัะบะธ

**ะกะตะณะผะตะฝัะฐัะธั** (`src/segmentation.py`):
- ะะพะดะตะปั: DeepLabv3 ResNet-101
- ะะปะฐััั: person, car, bus, truck, dog, cat, horse, ะธ ะดั.

**ะกัะฐะฑะธะปะธะทะฐัะธั** (`src/stabilization.py`):
- Moving Average โ ัะบะพะปัะทััะตะต ััะตะดะฝะตะต
- Median Filter โ ะผะตะดะธะฐะฝะฝัะน ัะธะปััั
- Exponential Smoothing โ ัะบัะฟะพะฝะตะฝัะธะฐะปัะฝะพะต ัะณะปะฐะถะธะฒะฐะฝะธะต

**ะะตััะธะบะธ** (`src/metrics.py`):
- IoU (Intersection over Union)
- Dice coefficient
- Temporal consistency

---

## ะกะตัะตะฒะฐั ะธะฝััะฐััััะบัััะฐ

### ะงัะพ ัะฐะบะพะต ะพะฑัะฐัะฝัะน SSH-ััะฝะฝะตะปั?

ะะฑััะฝะพ SSH ัะฐะฑะพัะฐะตั ัะฐะบ: ะฒั ะฟะพะดะบะปััะฐะตัะตัั ะ ัะตัะฒะตัั.

ะะฑัะฐัะฝัะน ััะฝะฝะตะปั ัะฐะฑะพัะฐะตั ะฝะฐะพะฑะพัะพั: ัะตัะฒะตั "ะฟัะพะฑัะฐััะฒะฐะตั" ัะฒะพะน ะฟะพัั ะฝะฐ ะฒะฐัั ะผะฐัะธะฝั.

```bash
ssh -R 0.0.0.0:8080:localhost:8080 user@your-server
```

ะญัะฐ ะบะพะผะฐะฝะดะฐ ะพะทะฝะฐัะฐะตั:
- `-R` โ ัะพะทะดะฐัั ะพะฑัะฐัะฝัะน ััะฝะฝะตะปั
- `0.0.0.0:8080` โ ัะปััะฐัั ะฝะฐ ะฒัะตั ะธะฝัะตััะตะนัะฐั ะฒะฐัะตะณะพ ัะตัะฒะตัะฐ ะฝะฐ ะฟะพััั 8080
- `localhost:8080` โ ะฟะตัะตะฝะฐะฟัะฐะฒะปััั ะฝะฐ ะปะพะบะฐะปัะฝัะน ะฟะพัั 8080 (ะฒ ะบะพะฝัะตะนะฝะตัะต)
- `user@your-server` โ ะฟะพะดะบะปััะธัััั ะบ ะฒะฐัะตะผั ัะตัะฒะตัั

### SSH-ะบะปััะธ ะดะปั ะฐะฒัะพะผะฐัะธะทะฐัะธะธ

ะงัะพะฑั ะฝะต ะฒะฒะพะดะธัั ะฟะฐัะพะปั ะบะฐะถะดัะน ัะฐะท, ะธัะฟะพะปัะทััััั SSH-ะบะปััะธ.

**ะัะธะฝัะธะฟ:**
1. ะะตะฝะตัะธััะตััั ะฟะฐัะฐ ะบะปััะตะน: ะฟัะธะฒะฐัะฝัะน (ัะตะบัะตัะฝัะน) ะธ ะฟัะฑะปะธัะฝัะน
2. ะัะฑะปะธัะฝัะน ะบะปัั ะดะพะฑะฐะฒะปัะตััั ะฝะฐ ัะตัะฒะตั ะฒ `~/.ssh/authorized_keys`
3. ะัะธ ะฟะพะดะบะปััะตะฝะธะธ ัะธััะตะผะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟัะพะฒะตััะตั ะบะปััะธ

---

## ะฃััะฐะฝะพะฒะบะฐ ะธ ะฝะฐัััะพะนะบะฐ

### ะจะฐะณ 1: ะะฐัััะพะนะบะฐ Windows-ัะตัะฒะตัะฐ

#### 1.1 ะะบะปััะธัะต SSH-ัะตัะฒะตั

```powershell
# PowerShell ะพั ะฐะดะผะธะฝะธัััะฐัะพัะฐ
Start-Service sshd
Set-Service -Name sshd -StartupType Automatic
```

#### 1.2 ะะฐัััะพะนัะต ัะฐะนัะฒะพะป

```powershell
New-NetFirewallRule -Name "SSH" -DisplayName "SSH Server" -Protocol TCP -LocalPort 22 -Action Allow -Direction Inbound
New-NetFirewallRule -Name "WebApp8080" -DisplayName "Web Frontend" -Protocol TCP -LocalPort 8080 -Action Allow -Direction Inbound
New-NetFirewallRule -Name "WebApp8000" -DisplayName "Web Backend" -Protocol TCP -LocalPort 8000 -Action Allow -Direction Inbound
```

#### 1.3 ะะบะปััะธัะต GatewayPorts

ะััะตะดะฐะบัะธััะนัะต `C:\ProgramData\ssh\sshd_config`:
```
GatewayPorts yes
```

ะะตัะตะทะฐะฟัััะธัะต SSH:
```powershell
Restart-Service sshd
```

### ะจะฐะณ 2: ะะฐัััะพะนะบะฐ SSH-ะบะปััะตะน (ะดะปั ะฐะฒัะพะผะฐัะธะทะฐัะธะธ)

#### 2.1 ะกะพะทะดะฐะนัะต ะบะปััะธ ะฒ Docker-ะบะพะฝัะตะนะฝะตัะต

```bash
ssh-keygen -t ed25519 -f ~/.ssh/id_tunnel -N ""
cat ~/.ssh/id_tunnel.pub
```

#### 2.2 ะะพะฑะฐะฒััะต ะฟัะฑะปะธัะฝัะน ะบะปัั ะฝะฐ Windows

```powershell
# ะกะพะทะดะฐะนัะต ัะฐะนะป (PowerShell)
New-Item -Path "$env:USERPROFILE\.ssh" -ItemType Directory -Force
Add-Content -Path "$env:USERPROFILE\.ssh\authorized_keys" -Value "ะะกะขะะะฌะขะ_ะะฃะะะะงะะซะ_ะะะฎะง"
```

#### 2.3 ะะปั ะฐะดะผะธะฝะธัััะฐัะพัะพะฒ Windows (ะฒะฐะถะฝะพ!)

```powershell
# ะะปััะธ ะฐะดะผะธะฝะธัััะฐัะพัะพะฒ ััะฐะฝัััั ะฒ ะดััะณะพะผ ะผะตััะต
Add-Content -Path "C:\ProgramData\ssh\administrators_authorized_keys" -Value "ะะกะขะะะฌะขะ_ะะฃะะะะงะะซะ_ะะะฎะง"

# ะฃััะฐะฝะพะฒะธัะต ะฟัะฐะฒะธะปัะฝัะต ะฟัะฐะฒะฐ
icacls "C:\ProgramData\ssh\administrators_authorized_keys" /inheritance:r /grant "SYSTEM:(F)" /grant "Administrators:(F)"
```

### ะจะฐะณ 3: ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
/tf/darachubarova/defliker/
โโโ src/
โ   โโโ __init__.py
โ   โโโ main.py          # FastAPI ัะตัะฒะตั
โ   โโโ segmentation.py  # DeepLabv3
โ   โโโ stabilization.py # ะะตัะพะดั ััะฐะฑะธะปะธะทะฐัะธะธ
โ   โโโ metrics.py       # ะะฐัััั ะผะตััะธะบ
โ   โโโ utils.py         # ะฃัะธะปะธัั
โโโ frontend/
โ   โโโ index.html       # ะะตะฑ-ะธะฝัะตััะตะนั
โโโ results/
โ   โโโ uploads/         # ะะฐะณััะถะตะฝะฝัะต ะฒะธะดะตะพ
โ   โโโ outputs/         # ะะตะทัะปััะฐัั ะพะฑัะฐะฑะพัะบะธ
โโโ logs/                # ะะพะณะธ
โโโ start_system.sh      # ะกะบัะธะฟั ะทะฐะฟััะบะฐ
โโโ requirements.txt     # ะะฐะฒะธัะธะผะพััะธ Python
```

---

## ะะฐะฟััะบ ัะธััะตะผั

### ะะฒัะพะผะฐัะธัะตัะบะธะน ะทะฐะฟััะบ (ัะตะบะพะผะตะฝะดัะตััั)

```bash
cd /tf/darachubarova/defliker
./start_system.sh
```

### ะััะฝะพะน ะทะฐะฟััะบ

#### ะขะตัะผะธะฝะฐะป 1: Backend
```bash
cd /tf/darachubarova/defliker
uvicorn src.main:app --host 0.0.0.0 --port 8000
```

#### ะขะตัะผะธะฝะฐะป 2: Frontend
```bash
cd /tf/darachubarova/defliker/frontend
python3 -m http.server 8080
```

#### ะขะตัะผะธะฝะฐะป 3: SSH-ััะฝะฝะตะปั
```bash
ssh -R 0.0.0.0:8000:localhost:8000 -R 0.0.0.0:8080:localhost:8080 Admin@23.189.104.205
```

### ะัะพะฒะตัะบะฐ ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััะธ

```bash
# Backend
curl http://localhost:8000

# Frontend
curl http://localhost:8080

# ะงะตัะตะท ััะฝะฝะตะปั (ั ะดััะณะพะณะพ ะบะพะผะฟัััะตัะฐ)
curl http://23.189.104.205:8000
curl http://23.189.104.205:8080
```

---

## ะัะฟะพะปัะทะพะฒะฐะฝะธะต

### ะะฑัะฐะฑะพัะบะฐ ะฒะธะดะตะพ ัะตัะตะท ะฒะตะฑ-ะธะฝัะตััะตะนั

1. ะัะบัะพะนัะต ะฒ ะฑัะฐัะทะตัะต: `http://23.189.104.205:8080`
2. ะะตัะตัะฐัะธัะต ะฒะธะดะตะพัะฐะนะป ะฒ ะทะพะฝั ะทะฐะณััะทะบะธ
3. ะัะฑะตัะธัะต ะบะปะฐัั ะพะฑัะตะบัะฐ (Person, Car, ะธ ั.ะด.)
4. ะัะฑะตัะธัะต ะผะตัะพะด ััะฐะฑะธะปะธะทะฐัะธะธ
5. ะะฐัััะพะนัะต ะฟะฐัะฐะผะตััั (Window Size ะธะปะธ Alpha)
6. ะะฐะถะผะธัะต "STABILIZE VIDEO"
7. ะะพะถะดะธัะตัั ะทะฐะฒะตััะตะฝะธั ะพะฑัะฐะฑะพัะบะธ
8. ะัะพัะผะพััะธัะต ัะตะทัะปััะฐัั ะธ ะผะตััะธะบะธ

### ะะฐัะฐะผะตััั ััะฐะฑะธะปะธะทะฐัะธะธ

**Moving Average:**
- Window Size: 3-9 (ะฝะตัััะฝัะต ัะธัะปะฐ)
- ะะพะปััะต = ัะธะปัะฝะตะต ัะณะปะฐะถะธะฒะฐะฝะธะต, ะฝะพ ะผะตะดะปะตะฝะฝะตะต ัะตะฐะบัะธั

**Median Filter:**
- Window Size: 3-9
- ะัััะต ัะฑะธัะฐะตั ะฒัะฑัะพัั, ัะพััะฐะฝัะตั ะบัะฐั

**Exponential Smoothing:**
- Alpha: 0.1-0.9
- ะะตะฝััะต = ัะธะปัะฝะตะต ัะณะปะฐะถะธะฒะฐะฝะธะต
- ะะพะปััะต = ะฑััััะตะต ัะตะฐะบัะธั

---

## ะฃัััะฐะฝะตะฝะธะต ะฝะตะฟะพะปะฐะดะพะบ

### ะัะพะฑะปะตะผะฐ: ะขัะฝะฝะตะปั ะพัะบะปััะฐะตััั

**ะกะธะผะฟัะพะผั:** ะกะฐะนั ะฟะตัะตััะฐัั ะพัะบััะฒะฐัััั ัะตัะตะท ะฝะตัะบะพะปัะบะพ ะผะธะฝัั.

**ะะตัะตะฝะธะต:** ะัะฟะพะปัะทัะนัะต autossh ะธะปะธ ะฟะฐัะฐะผะตััั keepalive:
```bash
ssh -o ServerAliveInterval=60 -o ServerAliveCountMax=3 -R ...
```

### ะัะพะฑะปะตะผะฐ: "Address already in use"

**ะกะธะผะฟัะพะผั:** ะะพัั ะทะฐะฝัั ะฟัะธ ะทะฐะฟััะบะต ัะตัะฒะตัะฐ.

**ะะตัะตะฝะธะต:**
```bash
pkill -f "http.server"
pkill -f "uvicorn"
```

### ะัะพะฑะปะตะผะฐ: "ndarray is not JSON serializable"

**ะกะธะผะฟัะพะผั:** ะัะธะฑะบะฐ ะฟัะธ ัะพััะฐะฝะตะฝะธะธ ัะตะทัะปััะฐัะพะฒ.

**ะะตัะตะฝะธะต:** ะฃะฑะตะดะธัะตัั, ััะพ ะฒ `save_job_state` ัะดะฐะปััััั ะฒัะต numpy-ะผะฐััะธะฒั:
```python
job_data.pop('frames', None)
job_data.pop('masks_before', None)
job_data.pop('masks_after', None)
job_data.pop('binary_masks', None)
```

### ะัะพะฑะปะตะผะฐ: SSH ะฝะต ะฟะพะดะบะปััะฐะตััั

**ะัะพะฒะตัััะต:**
1. ะะฐะฟััะตะฝ ะปะธ SSH ะฝะฐ Windows: `Get-Service sshd`
2. ะัะบััั ะปะธ ะฟะพัั 22: `Test-NetConnection -ComputerName localhost -Port 22`
3. ะะฐัััะพะตะฝ ะปะธ GatewayPorts ะฒ sshd_config
4. ะะฐะทัะตััะฝ ะปะธ ะฟะพัั ะฒ ัะฐะนัะฒะพะปะต

### ะัะพะฑะปะตะผะฐ: ะะฑัะฐะฑะพัะบะฐ ะพัะตะฝั ะผะตะดะปะตะฝะฝะฐั

**ะัะธัะธะฝั ะธ ัะตัะตะฝะธั:**
1. **ะะพะปััะพะต ะฒะธะดะตะพ** โ ะัะฟะพะปัะทัะนัะต ะฒะธะดะตะพ ะบะพัะพัะต 30 ัะตะบัะฝะด ะดะปั ัะตััะพะฒ
2. **ะะตั GPU** โ ะัะพะฒะตัััะต `nvidia-smi`, ะฝะฐัััะพะนัะต CUDA
3. **ะะฐะปะพ ะฟะฐะผััะธ** โ ะฃะผะตะฝััะธัะต ัะฐะทัะตัะตะฝะธะต ะฒะธะดะตะพ

---

## ะะฟัะธะผะธะทะฐัะธั

### ะะฝะพะณะพะฟะพัะพัะฝะฐั ะพะฑัะฐะฑะพัะบะฐ

ะะปั ััะบะพัะตะฝะธั ัะตะณะผะตะฝัะฐัะธะธ ะผะพะถะฝะพ ะดะพะฑะฐะฒะธัั ะฒ `segmentation.py`:

```python
from concurrent.futures import ThreadPoolExecutor

def segment_video_parallel(self, frames, target_class=None, max_workers=4):
    with ThreadPoolExecutor(max_workers=max_workers) as executor:
        results = list(executor.map(
            lambda f: self.segment_frame(f, target_class), 
            frames
        ))
    return results
```

### GPU-ััะบะพัะตะฝะธะต

ะฃะฑะตะดะธัะตัั, ััะพ PyTorch ะธัะฟะพะปัะทัะตั GPU:

```python
import torch
print(f"CUDA available: {torch.cuda.is_available()}")
print(f"Device: {torch.cuda.get_device_name(0)}")
```

### ะััะธัะพะฒะฐะฝะธะต ะผะพะดะตะปะตะน

ะะพะดะตะปั ะทะฐะณััะถะฐะตััั ะพะดะธะฝ ัะฐะท ะฟัะธ ััะฐััะต ัะตัะฒะตัะฐ (ัะถะต ัะตะฐะปะธะทะพะฒะฐะฝะพ ะฒ `get_segmenter()`).

---

## ะะพะปะตะทะฝัะต ะบะพะผะฐะฝะดั

```bash
# ะัะพะฒะตัะธัั ะปะพะณะธ backend
tail -f /tf/darachubarova/defliker/logs/backend.log

# ะัะพะฒะตัะธัั ััะฐััั ะทะฐะดะฐะฝะธั
curl http://localhost:8000/api/status/JOB_ID

# ะกะฟะธัะพะบ ะทะฐะดะฐะฝะธะน
ls /tf/darachubarova/defliker/results/outputs/

# ะัะธััะธัั ัะตะทัะปััะฐัั
rm -rf /tf/darachubarova/defliker/results/outputs/*
rm -rf /tf/darachubarova/defliker/results/uploads/*

# ะะตัะตะทะฐะฟัััะธัั ะฒัั
pkill -f uvicorn; pkill -f "http.server"; pkill -f "ssh -R"
```

---

## ะะฒัะพัั ะธ ะฑะปะฐะณะพะดะฐัะฝะพััะธ

ะกะธััะตะผะฐ ัะฐะทัะฐะฑะพัะฐะฝะฐ ะดะปั ััะตะฑะฝัั ัะตะปะตะน.

**ะขะตัะฝะพะปะพะณะธะธ:**
- FastAPI โ ะฒะตะฑ-ััะตะนะผะฒะพัะบ
- PyTorch + torchvision โ ะฝะตะนัะพัะตัะธ
- DeepLabv3 โ ัะตะผะฐะฝัะธัะตัะบะฐั ัะตะณะผะตะฝัะฐัะธั
- OpenCV โ ะพะฑัะฐะฑะพัะบะฐ ะฒะธะดะตะพ
- NumPy/SciPy โ ัะธัะปะตะฝะฝัะต ะฒััะธัะปะตะฝะธั

---

*ะะพะบัะผะตะฝั ัะพะทะดะฐะฝ: ะะตะบะฐะฑัั 2024*
