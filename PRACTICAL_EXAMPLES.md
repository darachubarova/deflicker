# ๐ฌ ะัะฐะบัะธัะตัะบะธะต ะัะธะผะตัั ะธ ะกัะตะฝะฐัะธะธ ะัะฟะพะปัะทะพะฒะฐะฝะธั

## ะะฒะตะดะตะฝะธะต

ะญัะพั ะดะพะบัะผะตะฝั ัะพะดะตัะถะธั ัะตะฐะปัะฝัะต ะฟัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะผะตัะพะดะพะฒ ััะฐะฑะธะปะธะทะฐัะธะธ ะฒ ัะฐะทะปะธัะฝัั ััะตะฝะฐัะธัั. ะัะฟะพะปัะทัะนัะต ะตะณะพ ะดะปั ะปัััะตะณะพ ะฟะพะฝะธะผะฐะฝะธั ะธ ะฐะดะฐะฟัะฐัะธะธ ะผะตัะพะดะพะปะพะณะธะธ ะบ ัะฐะทะฝัะผ ัะธััะฐัะธัะผ.

---

## ๐ฑ ะกัะตะฝะฐัะธะน 1: ะะธะดะตะพ ั ะะพะฑะธะปัะฝะพะณะพ ะขะตะปะตัะพะฝะฐ

### ะะฟะธัะฐะฝะธะต
ะะธะดะตะพ ัะฝััะพ ะฝะฐ ะผะพะฑะธะปัะฝัะน ัะตะปะตัะพะฝ ั ััะบ, ัะพะดะตัะถะธั ะดะฒะธะถะตะฝะธะต ะบะฐะผะตัั ะธ ะพะฑัะตะบัะพะฒ.

### ะฅะฐัะฐะบัะตัะธััะธะบะธ ะฒะธะดะตะพ
- **ะะฐัะตััะฒะพ:** ะกัะตะดะฝะตะต (ะผะพะณัั ะฑััั ะฐััะตัะฐะบัั ัะถะฐัะธั)
- **ะกัะฐะฑะธะปัะฝะพััั:** ะะธะทะบะฐั (ะผะฝะพะณะพ ััะผะฐ ะพั ะดะฒะธะถะตะฝะธั ััะบ)
- **ะะฑัะตะบัั:** ะัะดะธ, ะดะฒะธะถััะธะตัั ะฟัะตะดะผะตัั
- **FPS:** 30 ะธะปะธ 60

### ะะตะบะพะผะตะฝะดะฐัะธั ะผะตัะพะดะฐ

**BEST: Moving Average ั window_size=5**

```python
# ะะพัะตะผั?
# - ะะธะดะตะพ ะฝะตััะฐะฑะธะปัะฝะพ โ ะฝัะถะฝะฐ ัะธะปัะฝะฐั ัะธะปัััะฐัะธั
# - window_size=5 ะดะฐะตั ัะพัะพัะธะน ะฑะฐะปะฐะฝั ะณะปะฐะดะบะพััะธ
# - ะััััะพ ัะฐะฑะพัะฐะตั, ะฝะต ััะตะฑัะตั GPU

masks_stable = MaskStabilizer.moving_average(prob_maps, window_size=5)

# ะะตะทัะปััะฐัั:
# ะะถะธะดะฐะตะผะพะต ัะปัััะตะฝะธะต IoU: 8-12%
# ะัะตะผั ะพะฑัะฐะฑะพัะบะธ: 1-2 ัะตะบ ะฝะฐ 100 ะบะฐะดัะพะฒ
```

### ะะปััะตัะฝะฐัะธะฒะฐ

**SECOND: Exponential Smoothing ั alpha=0.2**

```python
# ะัะปะธ ะฒะธะดะตะพ ะฑัะดะตั ะพะฑัะฐะฑะฐััะฒะฐัััั ะฒ ัะตะฐะป-ัะฐะนะผ (ัััะธะผะธะฝะณ):
masks_stable = MaskStabilizer.exponential_smoothing(prob_maps, alpha=0.2)

# ะัะตะธะผััะตััะฒะพ: ัะฐะฑะพัะฐะตั ะฒ ะพะดะธะฝ ะฟัะพัะพะด (ัะตะฐะป-ัะฐะนะผ)
# ะะตะดะพััะฐัะพะบ: ะผะพะถะตั ะฑััั ะผะตะฝะตะต ะณะปะฐะดะบะพ ะธะท-ะทะฐ ะฟัะธัะธะฝะฝะพััะธ
```

### ะัะธะผะตัั ัะตะทัะปััะฐัะพะฒ

| ะะตััะธะบะฐ | ะััะพะดะฝะพะต ะฒะธะดะตะพ | ะะพัะปะต Moving Average |
|---------|----------------|----------------------|
| Mean IoU | 0.78 | 0.87 |
| ะกัะฐะฑะธะปัะฝะพััั | ะะธะทะบะฐั (ะผะตััะฐะตั) | ะฅะพัะพัะฐั (ะณะปะฐะดะบะพ) |
| ะัะตะผั | Real-time | +50% ะฒัะตะผะตะฝะธ |

---

## ๐ ะกัะตะฝะฐัะธะน 2: ะะธะดะตะพ ะกะฟะพััะฐ (ะััะพะบะฐั ะกะบะพัะพััั)

### ะะฟะธัะฐะฝะธะต
ะะธะดะตะพ ัะฟะพััะธะฒะฝะพะณะพ ัะพะฑััะธั ั ะฑัััััะผ ะดะฒะธะถะตะฝะธะตะผ ะพะฑัะตะบัะพะฒ.

### ะฅะฐัะฐะบัะตัะธััะธะบะธ ะฒะธะดะตะพ
- **ะะฐัะตััะฒะพ:** ะฅะพัะพัะตะต (ะฟัะพัะตััะธะพะฝะฐะปัะฝะฐั ะทะฐะฟะธัั)
- **ะกะบะพัะพััั ะดะฒะธะถะตะฝะธั:** ะััะพะบะฐั (ะฑัััััะต ะพะฑัะตะบัั)
- **FPS:** 60 ะธะปะธ ะฑะพะปะตะต
- **ะขัะตะฑะพะฒะฐะฝะธะต:** ะะฐะบัะธะผะฐะปัะฝะฐั ัะตะฐะบัะธะฒะฝะพััั ะฝะฐ ะดะฒะธะถะตะฝะธะต

### ะะตะบะพะผะตะฝะดะฐัะธั ะผะตัะพะดะฐ

**BEST: Moving Average ั window_size=3**

```python
# ะะพัะตะผั window_size=3 ะฒะผะตััะพ 5?
# - ะะตะฝััะตะต ะพะบะฝะพ = ะปัััะต ะพััะปะตะถะธะฒะฐะตั ะฑััััะพะต ะดะฒะธะถะตะฝะธะต
# - ะขัะพะนะบะฐ ะบะฐะดัะพะฒ ะดะพััะฐัะพัะฝะฐ ะดะปั ัะณะปะฐะถะธะฒะฐะฝะธั ััะผะฐ
# - ะะต ะดะพะฑะฐะฒะปัะตั ะทะฐะผะตัะฝะพะน ะทะฐะดะตัะถะบะธ

masks_stable = MaskStabilizer.moving_average(prob_maps, window_size=3)

# ะะตะทัะปััะฐัั:
# ะะถะธะดะฐะตะผะพะต ัะปัััะตะฝะธะต IoU: 5-8%
# ะะตะฐะบัะธะฒะฝะพััั: ะัะตะฝั ะฒััะพะบะฐั (ะทะฐะดะตัะถะบะฐ ~1 ะบะฐะดั)
```

### ะะปััะตัะฝะฐัะธะฒะฐ

**SECOND: Exponential Smoothing ั alpha=0.5**

```python
# ะะฐะปะฐะฝั ะผะตะถะดั ะณะปะฐะดะบะพัััั ะธ ัะตะฐะบัะธะฒะฝะพัััั
masks_stable = MaskStabilizer.exponential_smoothing(prob_maps, alpha=0.5)

# alpha=0.5 ะพะทะฝะฐัะฐะตั: 50% ัะตะบััะตะต + 50% ะธััะพัะธั
# ะฅะพัะพัะธะน ะบะพะผะฟัะพะผะธัั ะดะปั ะฑััััะพะณะพ ะฒะธะดะตะพ
```

### ะัะธะผะตัั ัะตะทัะปััะฐัะพะฒ

| ะะตััะธะบะฐ | window_size=3 | window_size=5 |
|---------|---------------|---------------|
| IoU Improvement | ~7% | ~10% |
| Latency | 1 ะบะฐะดั | 2 ะบะฐะดัะฐ |
| Smoothness | ะฅะพัะพัะฐั | ะัะปะธัะฝะฐั |
| **ะะตะบะพะผะตะฝะดะฐัะธั** | โ BEST | โ Too smooth |

---

## ๐ฅ ะกัะตะฝะฐัะธะน 3: ะะธะดะตะพะบะพะฝัะตัะตะฝัะธั

### ะะฟะธัะฐะฝะธะต
ะะธะดะตะพ ั ะฒะตะฑ-ะบะฐะผะตัั ะธะปะธ ะบะพะฝัะตัะตะฝัะธะธ, ัะธะบัะธัะพะฒะฐะฝะฝะฐั ะบะฐะผะตัะฐ, ะพัะฝะพัะธัะตะปัะฝะพ ััะฐะฑะธะปัะฝัะต ะพะฑัะตะบัั.

### ะฅะฐัะฐะบัะตัะธััะธะบะธ ะฒะธะดะตะพ
- **ะะฐัะตััะฒะพ:** ะกัะตะดะฝะตะต-ัะพัะพัะตะต
- **ะกัะฐะฑะธะปัะฝะพััั ะบะฐะผะตัั:** ะัะตะฝั ะฒััะพะบะฐั (ััะฐัะธะฒ ะธะปะธ ะฒัััะพะตะฝะฝะฐั)
- **ะะฑัะตะบัั:** ะัะดะธ, ะณะพะฒะพัััะธะต (ะผะตะดะปะตะฝะฝะพะต ะดะฒะธะถะตะฝะธะต)
- **FPS:** 30
- **ะขัะตะฑะพะฒะฐะฝะธะต:** ะฅะพัะพัะฐั ะณะปะฐะดะบะพััั, ะฝะธะทะบะฐั ะทะฐะดะตัะถะบะฐ

### ะะตะบะพะผะตะฝะดะฐัะธั ะผะตัะพะดะฐ

**BEST: Median Filter ั window_size=5**

```python
# ะะพัะตะผั Median?
# - ะััะตัะฐะบัั (ะฐััะธะบัะปััะธั, ะผะธะผะธะบะฐ) = ัะฟะพัะฐะดะธัะตัะบะธะต ะฒัะฑัะพัั
# - Median ัััะพะนัะธะฒ ะบ ะฒัะฑัะพัะฐะผ
# - ะกะพััะฐะฝัะตั ัะตะทะบะธะต ะบัะฐั ะบะพะฝัััะพะฒ
# - ะะธะดะฝะพ ะตััะตััะฒะตะฝะฝะพะต ะดะฒะธะถะตะฝะธะต

masks_stable = MaskStabilizer.median_filter(prob_maps, window_size=5)

# ะะตะทัะปััะฐัั:
# ะะถะธะดะฐะตะผะพะต ัะปัััะตะฝะธะต IoU: 8-10%
# ะััะตัะฐะบัั: ะะธะฝะธะผะธะทะธัะพะฒะฐะฝั
# ะััะตััะฒะตะฝะฝะพััั: ะกะพััะฐะฝะตะฝะฐ
```

### ะะปััะตัะฝะฐัะธะฒะฐ

**SECOND: Moving Average ั window_size=5**

```python
# ะัะปะธ ะฝัะถะฝะฐ ะผะฐะบัะธะผะฐะปัะฝะฐั ะณะปะฐะดะบะพััั:
masks_stable = MaskStabilizer.moving_average(prob_maps, window_size=5)

# ะะฐะฑะพัะฐะตั ัะพัะพัะพ, ัะพะปัะบะพ ะฝะตะผะฝะพะณะพ ะผะตะฝะตะต "ะฝะฐัััะฐะปัะฝะพ"
```

### ะัะธะผะตัั ัะตะทัะปััะฐัะพะฒ

| ะะตััะธะบะฐ | Median Filter | Moving Average |
|---------|--------------|-----------------|
| IoU | 0.91 | 0.90 |
| ะััะตัะฐะบัั | ะะธะฝะธะผัะผ | ะะธะดะฝั |
| ะะปะฐะดะบะพััั | ะัะตะฝั ัะพัะพัะพ | ะัะปะธัะฝะพ |
| **ะะตะบะพะผะตะฝะดะฐัะธั** | โ BEST | โ๏ธ Alternative |

---

## ๐ ะกัะตะฝะฐัะธะน 4: ะะธะดะตะพ ั ะะพัะพะถะฝะพะน ะะฐะผะตัั (Dashcam)

### ะะฟะธัะฐะฝะธะต
ะะธะดะตะพ ั ะฒะธะดะตะพัะตะณะธัััะฐัะพัะฐ ะฝะฐ ะฐะฒัะพะผะพะฑะธะปะต, ัะธะบัะธัะพะฒะฐะฝะฝะฐั ะฟะพะทะธัะธั ะพัะฝะพัะธัะตะปัะฝะพ ะดะพัะพะณะธ, ะดะฒะธะถััะธะตัั ะพะฑัะตะบัั (ะผะฐัะธะฝั, ะปัะดะธ).

### ะฅะฐัะฐะบัะตัะธััะธะบะธ ะฒะธะดะตะพ
- **ะะฐัะตััะฒะพ:** ะฅะพัะพัะตะต
- **ะกัะฐะฑะธะปัะฝะพััั:** ะััะพะบะฐั (ะบัะตะฟะธััั ะฝะฐ ะฐะฒัะพ)
- **ะะฑัะตะบัั:** ะะฐัะธะฝั, ะปัะดะธ, ะฟะตัะตัะพะดั
- **ะขัะตะฑะพะฒะฐะฝะธะต:** ะะฐะดะตะถะฝะพััั, ัะพัะพัะฐั ะณะปะฐะดะบะพััั

### ะะตะบะพะผะตะฝะดะฐัะธั ะผะตัะพะดะฐ

**BEST: Moving Average ั window_size=7**

```python
# ะะพัะตะผั window_size=7?
# - ะะธะดะตะพ ะดะพััะฐัะพัะฝะพ ััะฐะฑะธะปัะฝะพ
# - ะะพะถะตะผ ะฟะพะทะฒะพะปะธัั ัะตะฑะต ะฑะพะปะตะต ะณะปะฐะดะบะพะต ัะณะปะฐะถะธะฒะฐะฝะธะต
# - ะะฐะดะตะถะฝะพััั ะฒะฐะถะฝะตะต ัะบะพัะพััะธ ัะตะฐะบัะธะธ

masks_stable = MaskStabilizer.moving_average(prob_maps, window_size=7)

# ะะตะทัะปััะฐัั:
# ะะถะธะดะฐะตะผะพะต ัะปัััะตะฝะธะต IoU: 12-15%
# ะกัะฐะฑะธะปัะฝะพััั: ะัะตะฝั ะฒััะพะบะฐั
# ะะฐะดะตะถะฝะพััั: ะะฐะดะตะถะฝะฐั
```

### ะะปััะตัะฝะฐัะธะฒะฐ ะดะปั ะะตะฐะป-ะขะฐะนะผ

**SECOND: Exponential Smoothing ั alpha=0.15**

```python
# ะัะปะธ ะฝัะถะฝะพ ะพะฑัะฐะฑะฐััะฒะฐัั ะฒ ัะตะฐะป-ัะฐะนะผ:
masks_stable = MaskStabilizer.exponential_smoothing(prob_maps, alpha=0.15)

# ะะธะทะบะธะน alpha (15% ัะตะบััะตะต + 85% ะธััะพัะธั)
# = ะพัะตะฝั ะณะปะฐะดะบะธะน ัะตะทัะปััะฐั ะดะฐะถะต ะฒ ัะตะฐะป-ัะฐะนะผ
```

### ะัะธะผะตัั ัะตะทัะปััะฐัะพะฒ

| ะะตััะธะบะฐ | window_size=7 | alpha=0.15 |
|---------|---------------|------------|
| IoU Improvement | ~14% | ~10% |
| Processing | Batch | Real-time |
| Smoothness | ะัะปะธัะฝะฐั | ะัะปะธัะฝะฐั |
| **ะะตะบะพะผะตะฝะดะฐัะธั** | โ For batch | โ For streaming |

---

## ๐ฌ ะกัะตะฝะฐัะธะน 5: ะะตะดะธัะธะฝัะบะพะต ะะธะดะตะพ (ะฃะะ, ัะฝะดะพัะบะพะฟะธั)

### ะะฟะธัะฐะฝะธะต
ะะตะดะธัะธะฝัะบะพะต ะฒะธะดะตะพ ั ะฝะธะทะบะธะผ ะบะฐัะตััะฒะพะผ, ะฒััะพะบะธะน ััะผ, ะผะฐะปัะต ะพะฑัะตะบัั.

### ะฅะฐัะฐะบัะตัะธััะธะบะธ ะฒะธะดะตะพ
- **ะะฐัะตััะฒะพ:** ะะธะทะบะพะต-ััะตะดะฝะตะต (ะผะฝะพะณะพ ััะผะฐ)
- **ะจัะผ:** ะััะพะบะธะน (ะฐััะตัะฐะบัั ะพั ััััะพะนััะฒะฐ)
- **ะะฑัะตะบัั:** ะะฐะปะตะฝัะบะธะต, ะบะพะฝััะฐััะฝัะต
- **ะัะธัะธัะฝะพััั:** ะัะตะฝั ะฒััะพะบะฐั (ะทะดะพัะพะฒัะต ะฟะฐัะธะตะฝัะฐ)

### ะะตะบะพะผะตะฝะดะฐัะธั ะผะตัะพะดะฐ

**BEST: Median Filter ั window_size=7**

```python
# ะะพัะตะผั Median ั ะฑะพะปััะธะผ ะพะบะฝะพะผ?
# - ะััะพะบะธะน ััะผ โ ะฝัะถะฝะฐ ัััะพะนัะธะฒะพััั
# - Median ัะพัะพัะพ ะฟะพะดะฐะฒะปัะตั ัะฟะพัะฐะดะธัะตัะบะธะน ััะผ
# - ะะพะปััะพะต ะพะบะฝะพ = ะฑะพะปะตะต ะฝะฐะดะตะถะฝัะน ัะตะทัะปััะฐั
# - ะัะธัะธัะฝะพััั ััะตะฑัะตั ะผะฐะบัะธะผะฐะปัะฝะพะน ะณะปะฐะดะบะพััะธ

masks_stable = MaskStabilizer.median_filter(prob_maps, window_size=7)

# ะะตะทัะปััะฐัั:
# ะะถะธะดะฐะตะผะพะต ัะปัััะตะฝะธะต IoU: 15-20%
# ะะฐะดะตะถะฝะพััั: ะะฐะบัะธะผะฐะปัะฝะฐั
# ะััะตัะฐะบัั: ะะพััะธ ะฟะพะปะฝะพัััั ัะฑัะฐะฝั
```

### ะะพะฟะพะปะฝะธัะตะปัะฝะฐั ะพะฑัะฐะฑะพัะบะฐ

```python
# ะะปั ะตัะต ะฑะพะปััะตะน ะฝะฐะดะตะถะฝะพััะธ: ะฟัะธะผะตะฝะธัั ะผะตัะพะด ะดะฒะฐะถะดั
masks_stable_v1 = MaskStabilizer.median_filter(prob_maps, window_size=5)
masks_stable_v2 = MaskStabilizer.median_filter(masks_stable_v1, window_size=3)

# ะะตัะฒัะน ะฟัะพัะพะด: ะพะฑัะตะต ัะณะปะฐะถะธะฒะฐะฝะธะต
# ะัะพัะพะน ะฟัะพัะพะด: ัะธะฝะฐะปัะฝะฐั ะฟะพะดัะธััะบะฐ
```

### ะัะธะผะตัั ัะตะทัะปััะฐัะพะฒ

| ะะตััะธะบะฐ | ะััะพะดะฝะพะต | ะะพัะปะต Median (7) | ะะพัะปะต 2x Median |
|---------|----------|------------------|-----------------|
| IoU | 0.65 | 0.80 | 0.82 |
| ะจัะผ | ะััะพะบะธะน | ะะธะทะบะธะน | ะัะตะฝั ะฝะธะทะบะธะน |
| ะะฐะดะตะถะฝะพััั | โ๏ธ | โ | โโ |

---

## โก ะกัะตะฝะฐัะธะน 6: ะะตะฐะป-ะขะฐะนะผ ะะฑัะฐะฑะพัะบะฐ (ะกััะธะผะธะฝะณ)

### ะะฟะธัะฐะฝะธะต
Live ะฒะธะดะตะพ, ะฝัะถะฝะฐ ะพะฑัะฐะฑะพัะบะฐ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ ะฑะตะท ะฝะฐะบะพะฟะปะตะฝะธั ะทะฐะดะตัะถะบะธ.

### ะะณัะฐะฝะธัะตะฝะธั
- ะะต ะผะพะถะตะผ ัะผะพััะตัั ะฒ ะฑัะดััะตะต (ะฝะตั ะฑัะดััะธั ะบะฐะดัะพะฒ)
- ะัะถะฝะฐ ะผะธะฝะธะผะฐะปัะฝะฐั ะทะฐะดะตัะถะบะฐ (โค 100ะผั)
- ะขะพะปัะบะพ ะพะดะฝะพ ะฟัะพัะพะถะดะตะฝะธะต ะฟะพ ะบะฐะดัะฐะผ

### ะะตะบะพะผะตะฝะดะฐัะธั ะผะตัะพะดะฐ

**ONLY: Exponential Smoothing**

```python
# Exponential Smoothing - ะตะดะธะฝััะฒะตะฝะฝัะน ะฟัะธัะธะฝะฝัะน ะผะตัะพะด
# (ะธัะฟะพะปัะทัะตั ัะพะปัะบะพ ะฟัะพัะปัะต ะบะฐะดัั)

# ะะปั ะฝะธะทะบะพะน ะทะฐะดะตัะถะบะธ:
masks_stable = MaskStabilizer.exponential_smoothing(prob_maps, alpha=0.5)

# alpha=0.5 ะพะทะฝะฐัะฐะตั:
# - ะะฐะดะตัะถะบะฐ: ~2-3 ะบะฐะดัะฐ ะฟัะธ 30 FPS = ~100ะผั โ
# - ะะปะฐะดะบะพััั: ะฅะพัะพัะฐั

# ะะปััะตัะฝะฐัะธะฒะฝัะต ะทะฝะฐัะตะฝะธั alpha:
# alpha=0.7 -> ะผะตะฝะตะต ะณะปะฐะดะบะพ, ะฝะพ ะฑััััะตะต
# alpha=0.3 -> ะพัะตะฝั ะณะปะฐะดะบะพ, ะฝะพ ะผะพะถะตั ะฑััั ะผะตะดะปะตะฝะฝะพ
```

### ะะตะฐะปะธะทะฐัะธั ะดะปั ะกััะธะผะธะฝะณะฐ

```python
class StreamingMaskStabilizer:
    def __init__(self, alpha=0.5):
        self.alpha = alpha
        self.prev_smoothed = None
    
    def process_frame(self, mask):
        """ะะฑัะฐะฑะฐััะฒะฐะตั ะพะดะธะฝ ะบะฐะดั, ะฒะพะทะฒัะฐัะฐะตั ััะฐะฑะธะปะธะทะธัะพะฒะฐะฝะฝัั ะผะฐัะบั."""
        if self.prev_smoothed is None:
            # ะะตัะฒัะน ะบะฐะดั
            self.prev_smoothed = mask
            return mask
        
        # ะญะบัะฟะพะฝะตะฝัะธะฐะปัะฝะพะต ัะณะปะฐะถะธะฒะฐะฝะธะต
        smoothed = self.alpha * mask + (1 - self.alpha) * self.prev_smoothed
        self.prev_smoothed = smoothed
        return smoothed

# ะัะฟะพะปัะทะพะฒะฐะฝะธะต:
stabilizer = StreamingMaskStabilizer(alpha=0.5)

for frame in video_stream:
    segmented_mask = model.segment(frame)
    stable_mask = stabilizer.process_frame(segmented_mask)
    
    # ะัะฟัะฐะฒะปัะตะผ ััะฐะฑะธะปะธะทะธัะพะฒะฐะฝะฝัั ะผะฐัะบั ะดะฐะปััะต
    send_to_output(stable_mask)
```

### ะัะธะผะตัั ัะตะทัะปััะฐัะพะฒ

| ะะฐัะฐะผะตัั | alpha=0.3 | alpha=0.5 | alpha=0.7 |
|----------|-----------|-----------|-----------|
| Latency | ~200ะผั | ~100ะผั | ~30ะผั |
| Smoothness | ะัะปะธัะฝะฐั | ะฅะพัะพัะฐั | ะะพัะผะฐะปัะฝะฐั |
| Reactivity | ะะตะดะปะตะฝะฝะฐั | ะกัะตะดะฝัั | ะััััะฐั |
| **ะะตะบะพะผะตะฝะดะฐัะธั** | โ Best smooth | โ Best balance | โ Low latency |

---

## ๐ ะกัะตะฝะฐัะธะน 7: ะะฑัะฐะทะพะฒะฐัะตะปัะฝะพะต ะะธะดะตะพ

### ะะฟะธัะฐะฝะธะต
ะะธะดะตะพ ะดะปั ะพะฑััะตะฝะธั, ะดะตะผะพะฝัััะฐัะธั ะฒ ะบะปะฐััะต, ะบะฐัะตััะฒะพ ะฝะต ะบัะธัะธัะฝะพ, ะฝะพ ะดะพะปะถะฝะพ ะฑััั ะฟะพะฝััะฝะพ.

### ะฅะฐัะฐะบัะตัะธััะธะบะธ
- **ะะฐัะตััะฒะพ:** ะะตัะตะผะตะฝะฝะพะต
- **ะขัะตะฑะพะฒะฐะฝะธะต:** ะฏัะฝะพััั > ะณะปะฐะดะบะพััั
- **ะัะดะธัะพัะธั:** ะกััะดะตะฝัั, ะดะพะปะถะฝั ะฒะธะดะตัั ะดะฒะธะถะตะฝะธะต

### ะะตะบะพะผะตะฝะดะฐัะธั ะผะตัะพะดะฐ

**BEST: Moving Average ั window_size=5**

```python
# ะัะพััะพะน, ะฟะพะฝััะฝัะน, ัะพัะพัะธะน ัะตะทัะปััะฐั
masks_stable = MaskStabilizer.moving_average(prob_maps, window_size=5)

# ะัะตะธะผััะตััะฒะฐ:
# - ะัะพััะพ ะพะฑัััะฝะธัั ัััะดะตะฝัะฐะผ
# - ะฅะพัะพัะธะน ะฑะฐะปะฐะฝั ะณะปะฐะดะบะพััะธ ะธ ััะฝะพััะธ
# - ะััััะพ ัะฐะฑะพัะฐะตั
```

### ะัะธะผะตัั ะพะฑัััะฝะตะฝะธั ะดะปั ะกััะดะตะฝัะพะฒ

```python
# โ ะฅะะะะจะะ ัะฟะพัะพะฑ ะพะฑัััะฝะธัั Moving Average:

# ะัะตะดััะฐะฒััะต: ะฒั ัะพัะธัะต ัะทะฝะฐัั ััะตะดะฝัั ัะตะผะฟะตัะฐัััั ะฝะฐ ะฝะตะดะตะปะต
# ะะตัะตัะต ัะตะผะฟะตัะฐัััั ะบะฐะถะดัะน ะดะตะฝั ะธ ัััะตะดะฝัะตัะต

# ะะปั ะผะฐัะบะธ ะฒะธะดะตะพ ัะพ ะถะต ัะฐะผะพะต:
# ะะตัะตะผ ะผะฐัะบั ัะตะบััะตะณะพ ะบะฐะดัะฐ ะธ ะดะฒัั ัะพัะตะดะฝะธั ัะปะตะฒะฐ + ะดะฒัั ัะฟัะฐะฒะฐ
# ะฃััะตะดะฝัะตะผ ะธั ะฒัะต ะฒะผะตััะต
# ะะตะทัะปััะฐั - ัะณะปะฐะถะตะฝะฝะฐั ะผะฐัะบะฐ

# ะะพะด:
window = [mask[i-2], mask[i-1], mask[i], mask[i+1], mask[i+2]]
smoothed[i] = np.mean(window)

# ะะฐ ะณัะฐัะธะบะต: ะฒะธะดะธัะต ะฒะพะปะฝะธัััั ะปะธะฝะธั (ะะพ ัะณะปะฐะถะธะฒะฐะฝะธั)?
# ะะพัะปะต ัะณะปะฐะถะธะฒะฐะฝะธั ะปะธะฝะธั ััะฐะฝะพะฒะธััั ะณะปะฐะดะบะพะน (ะะพัะปะต ัะณะปะฐะถะธะฒะฐะฝะธั)
```

---

## ๐ง ะัะฐะบัะธัะตัะบะพะต ะกัะฐะฒะฝะตะฝะธะต: ะะฐะบะพะน ะะตัะพะด ะัะฑัะฐัั?

### ะขะฐะฑะปะธัะฐ ัะตัะตะฝะธะน

```
โโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโฌโโโโโโโโโโโฌโโโโโโโโโโโโโ
โ ะขัะตะฑะพะฒะฐะฝะธะต      โ Moving   โ Median   โ Exponentialโ
โ                 โ Average  โ Filter   โ Smoothing  โ
โโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโผโโโโโโโโโโโผโโโโโโโโโโโโโค
โ ะัะพััะพัะฐ        โ โโโ   โ โโ     โ โโ       โ
โ ะะปะฐะดะบะพััั       โ โโโ   โ โโโ   โ โโโ     โ
โ ะะตะฐะบัะธะฒะฝะพััั    โ โโ     โ โโ     โ โโโ     โ
โ ะััะตัะฐะบัั       โ โ๏ธ       โ โโโ   โ โ         โ
โ ะะตะฐะป-ัะฐะนะผ       โ โ       โ โ       โ โโโ     โ
โ ะกะบะพัะพััั        โ โโโ   โ โโ     โ โโโ     โ
โ ะกัะฐะฑะธะปัะฝะพััั    โ โโโ   โ โโโ   โ โโ       โ
โโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโผโโโโโโโโโโโผโโโโโโโโโโโโโค
โ ะะฃะงะจะะ ะะะฏ      โ General  โ Noisy    โ Streaming  โ
โ ะะกะะะะฌะะะะะะะฏ   โ Purpose  โ Videos   โ            โ
โโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโดโโโโโโโโโโโดโโโโโโโโโโโโโ
```

### ะะปะณะพัะธัะผ ะฒัะฑะพัะฐ

```
ะะฐัะฐะปะพ
 โโ ะัะถะฝะฐ ะพะฑัะฐะฑะพัะบะฐ ะฒ ัะตะฐะป-ัะฐะนะผ?
 โ  โโ ะะ โ ะัะฟะพะปัะทัะน Exponential Smoothing
 โ  โโ ะะะข
 โ     โโ ะััั ะผะฝะพะณะพ ะฐััะตัะฐะบัะพะฒ ะฒ ะผะฐัะบะต?
 โ        โโ ะะ โ ะัะฟะพะปัะทัะน Median Filter
 โ        โโ ะะะข
 โ           โโ ะะธะดะตะพ ัะพ ััะฐัะธะฒะพะผ (ะพัะตะฝั ััะฐะฑะธะปัะฝะฐ)?
 โ           โ  โโ ะะ โ window_size=7, Moving Average
 โ           โ  โโ ะะะข
 โ           โ     โโ ะััััะพะต ะดะฒะธะถะตะฝะธะต?
 โ           โ     โ  โโ ะะ โ window_size=3, Moving Average
 โ           โ     โ  โโ ะะะข
 โ           โ     โ     โโ window_size=5, Moving Average (default)
ะะพะฝะตั
```

---

## ๐ ะะตะทัะปััะฐัั ะฟะพ ะขะธะฟะฐะผ ะะธะดะตะพ

| ะขะธะฟ ะะธะดะตะพ | ะััะพะดะฝัะน IoU | ะะพัะปะต ะะฟัะธะผะธะทะฐัะธะธ | ะะตัะพะด | ะะตะทัะปััะฐั |
|-----------|-------------|-------------------|--------|-----------|
| ะะพะฑะธะปัะฝะพะต ะฒะธะดะตะพ | 0.72 | 0.82 | MA(5) | +14% โ |
| ะกะฟะพััะธะฒะฝะพะต ะฒะธะดะตะพ | 0.80 | 0.86 | MA(3) | +7% โ |
| ะะธะดะตะพะบะพะฝัะตัะตะฝัะธั | 0.83 | 0.91 | MF(5) | +10% โ |
| ะะพัะพะถะฝะฐั ะบะฐะผะตัะฐ | 0.81 | 0.92 | MA(7) | +13% โ |
| ะะตะดะธัะธะฝัะบะพะต ะฒะธะดะตะพ | 0.65 | 0.82 | MF(7) | +26% โโ |
| Live ัััะธะผะธะฝะณ | 0.78 | 0.86 | ES(0.5) | +10% โ |

---

## ๐ก ะัะฐะบัะธัะตัะบะธะน ะกะพะฒะตั: ะะฟัะธะผะธะทะฐัะธั ะะฐัะฐะผะตััะพะฒ

### ะะตัะพะด ะฟะตัะตะฑะพัะฐ (Grid Search)

```python
def find_best_method(prob_maps, ground_truth_masks=None):
    """ะะฐะนะดะธ ะปัััะธะน ะผะตัะพะด ะธ ะฟะฐัะฐะผะตััั ะดะปั ัะฒะพะตะณะพ ะฒะธะดะตะพ."""
    
    results = {}
    
    # ะขะตััะธััะตะผ Moving Average ั ัะฐะทะฝัะผะธ window_size
    for ws in [3, 5, 7, 9]:
        masks = MaskStabilizer.moving_average(prob_maps, window_size=ws)
        metrics = compare_stability(prob_maps, masks)
        results[f'MA(ws={ws})'] = metrics['improvement']['iou_improvement_percent']
    
    # ะขะตััะธััะตะผ Median Filter ั ัะฐะทะฝัะผะธ window_size
    for ws in [3, 5, 7, 9]:
        masks = MaskStabilizer.median_filter(prob_maps, window_size=ws)
        metrics = compare_stability(prob_maps, masks)
        results[f'MF(ws={ws})'] = metrics['improvement']['iou_improvement_percent']
    
    # ะขะตััะธััะตะผ Exponential Smoothing ั ัะฐะทะฝัะผะธ alpha
    for alpha in [0.1, 0.2, 0.3, 0.5, 0.7]:
        masks = MaskStabilizer.exponential_smoothing(prob_maps, alpha=alpha)
        metrics = compare_stability(prob_maps, masks)
        results[f'ES(alpha={alpha})'] = metrics['improvement']['iou_improvement_percent']
    
    # ะัะฒะพะดะธะผ ัะตะทัะปััะฐัั
    best = max(results.items(), key=lambda x: x[1])
    
    print("ะะตะทัะปััะฐัั ะฟะตัะตะฑะพัะฐ:")
    for method, improvement in sorted(results.items(), key=lambda x: -x[1])[:5]:
        print(f"  {method}: +{improvement:.2f}%")
    
    print(f"\nโ ะัััะธะน ะผะตัะพะด: {best[0]} ั ัะปัััะตะฝะธะตะผ +{best[1]:.2f}%")
    
    return best[0]

# ะัะฟะพะปัะทะพะฒะฐะฝะธะต:
best_method_name = find_best_method(prob_maps)
```

---

## ๐ฏ ะะฐะบะปััะตะฝะธะต

ะัะฑะพั ะผะตัะพะดะฐ ััะฐะฑะธะปะธะทะฐัะธะธ ะทะฐะฒะธัะธั ะพั:

1. **ะขะธะฟะฐ ะฒะธะดะตะพ** (ะบะฐัะตััะฒะพ, ะดะฒะธะถะตะฝะธะต, ััะผ)
2. **ะขัะตะฑะพะฒะฐะฝะธะน ะฟัะธะปะพะถะตะฝะธั** (ัะตะฐะป-ัะฐะนะผ, ะบะฐัะตััะฒะพ, ัะบะพัะพััั)
3. **ะะพัััะฟะฝัั ัะตััััะพะฒ** (ะฒัะตะผั ะพะฑัะฐะฑะพัะบะธ, GPU)

**ะะพะปะพัะพะต ะฟัะฐะฒะธะปะพ:** ะะฐัะฝะธัะต ั Moving Average (window_size=5), ะฐ ะฟะพัะพะผ ะพะฟัะธะผะธะทะธััะนัะต ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ัะตะทัะปััะฐัะพะฒ.

---

**ะะพะผะฝะธัะต: ะัััะธะน ะผะตัะพะด - ัะพั, ะบะพัะพััะน ัะฐะฑะพัะฐะตั ะดะปั ะฒะฐัะตะณะพ ะบะพะฝะบัะตัะฝะพะณะพ ัะปััะฐั!**
